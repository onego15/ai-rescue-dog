# 🤖 プロトタイプゲーム仕様：レスキュー・エージェント・トライアル

## 1\. 概要

| 項目 | 詳細 |
| :--- | :--- |
| **ゲーム名** | AIレスキュードッグ |
| **ジャンル** | 3Dシミュレーション、パズル、リアルタイム戦略（AIエージェント視点） |
| **目標** | AIエージェント（犬型ロボット）が、ランダムに移動する敵を回避しながら、迷路内にいる救助対象（HELPターゲット）に到達すること。 |
| **開発環境** | 3D環境・描画 + OpenAI API (AIエージェントの意思決定ロジック) |
| **勝利条件** | エージェントがHELPターゲットに接触する。 |
| **敗北条件** | エージェントが敵（Enemy）に接触する。 |

## 2\. ゲーム環境とオブジェクト

| オブジェクト | 詳細 | 実装ヒント |
| :--- | :--- | :--- |
| **フィールド** | 均一なグリッド（マス目）で構成された3Dの迷路空間。壁によって通路が形成される。 | シンプルなキューブを組み合わせて迷路を構築。グリッド座標系（例: X, Y）で管理する。 |
| **AIエージェント** | 犬型ロボットなど（プレイヤー操作不可）。1ターンに1マス移動または90度回転。 | LLMの指示（`MOVE_FORWARD`, `TURN_LEFT`など）に従って動作する主役。 |
| **ターゲット** | 赤いNPCなど、「HELP」の文字が表示された救助対象。固定配置。 | 衝突判定（Collider）を付け、エージェントとの接触を検出する。 |
| **敵（Enemy）** | 敵キャラ。エージェントとは独立して、ランダムな方向へ移動し続ける。複数体配置。 | 独自のシンプルな移動ロジック（例: 一定確率で直進、回転、衝突したら反転）を実装。 |

## 3\. AIエージェントの意思決定ロジック (OpenAI API連携)

エージェントの行動は、OpenAI APIからの出力に完全に依存します。

### 3.1. エージェントの実行可能アクション

| アクション | 説明 |
| :--- | :--- |
| `MOVE_FORWARD` | 現在向いている方向に1マス前進する。 |
| `TURN_LEFT` | 左に90度回転する。 |
| `TURN_RIGHT` | 右に90度回転する。 |
| `STOP` | その場で停止する（ターゲットに到達した場合のみ）。 |

### 3.2. APIへの入力情報（センサーデータ）

ゲーム環境は、ターンごとに以下の情報を収集し、JSON形式のプロンプト（User Prompt）に含めてAPIに送信します。

  * **エージェントの状態:** 現在の座標 (X, Y) と向き (North, East, South, West)。
  * **センサー情報:**
      * **周囲の障害物:** 正面、左右、斜め前方の1マスまたは2マス先に「壁」があるか。
      * **ターゲット位置:** ターゲットまでの相対座標または方向（例：ターゲットは北東方向にある）。
      * **敵の位置と危険度:** センサー範囲内（例：周囲3マス以内）にいる**すべての敵の座標と距離、方向**。

### 3.3. APIからの出力

APIは、次の単一の行動コマンドをJSON形式で返します。

```json
{
  "action": "行動コマンド名" // 例: "MOVE_FORWARD"
}
```

## 4\. ゲームフロー（ターンベース処理）

1.  **環境初期化:** 迷路、エージェント、ターゲット、敵をランダムまたはプリセットの位置に配置。
2.  **敵の移動:** すべての敵が、それぞれのロジックに従い1マス移動する（ランダム移動）。
3.  **衝突判定（敗北チェック）:** エージェントと敵が接触していないかチェック。接触していればゲームオーバー。
4.  **センサーデータ収集:** エージェントの周囲の環境（壁、敵、ターゲット）を認識し、データをJSONプロンプトにまとめる。
5.  **LLM呼び出し:** OpenAI APIにプロンプトを送信し、次の行動コマンドを取得する。
6.  **エージェントの行動実行:** 取得したコマンドに従い、エージェントを1マス移動または回転させる。
7.  **衝突判定（勝利チェック）:** エージェントがターゲットに接触していればゲームクリア。
8.  **ループ:** 勝利または敗北がなければ、ステップ2に戻る（次のターンへ）。

## 5\. プロトタイピングの成功基準

  * **基本機能:** エージェントがAPIの出力に従って3D空間で動作すること。
  * **意思決定:** LLMが、壁を避け、ターゲットに向かうための適切な行動（`MOVE_FORWARD`や`TURN_LEFT`）を選択できること。
  * **リスクマネジメント:** 敵が接近した際、ターゲットへの最短ルートを諦めてでも、敵から遠ざかる行動（例: 敵とは逆方向に`TURN_LEFT`や`MOVE_FORWARD`）を選択できること。
